---
layout: post
title: volafunx - Volafox for FreeBSD
date: 2010-12-22 15:34:00.000000000 +09:00
type: post
published: true
status: publish
categories:
- Memory Forensics
tags: []
meta:
  blogger_blog: forensic.n0fate.com
  blogger_author: Kyeongsik Lee
  blogger_permalink: /2010/12/volafox-for-freebsd.html
  _blogger_self: https://www.blogger.com/feeds/7620918615785302711/posts/default/7260581877592230203
  _edit_last: '1'
  _oembed_d69e8097cc08a244d4a8483691e48f76: '{{unknown}}'
  avada_post_views_count: '955'
  fusion_builder_content_backup: |-
    <div></div><div></div>사실 예전 논문의 주제로 잡았던  Mac OS X 는 개인 데스크톱에서 많이 사용되지만, 서버시장을 바라보았을 땐 그 수요가 높지 않습니다. 이에 기업에서 사용하는 서버 시장에 이 기술을 적용해볼 수 있지 않을까해서 생각을 해보니  FreeBSD에 적용하면 그 사용 빈도가 더 높지 않을까란 생각이 들었습니다.<br /><br />이러한 생각으로 volafox 의 물리 메모리 분석 기술을  OSX 의 컴포넌트 중 하나로 사용되는  BSD 에 적용하였습니다. 아무래도  Mac OS X의 데이터 추출도 대부분  BSD 컴포넌트에서 데이터를 추출하다보니 좀더 빠르게 구현할 수 있었습니다.<br /><br />이름은 우선  volafunx 로 정하였는데요, 이는 차 후 통합되는 과정에서 변경될 수 있습니다.<br /> volafox 를 기반으로 작성하였지만, 물리 메모리 분석에 중요한 프로세스 덤프가 먼저 추가가 되어 있기 때문에, 현재까지는  volafox 보다 사용하기는 더 좋다고 생각합니다. :)<br /><br /> volafunx 를 구동하면 다음과 같은 화면을 확인하실 수 있습니다.<br /><br /><br /><span>n0fates-iMac:volafunx n0fate$ python volafunx.py </span><br /><br /><span>Memory analyzer for FreeBSD - n0fate</span><br /><span>Contact: rapfer@gmail.com</span><br /><span>usage: python volafunx.py -i MEMORY_IMAGE -s KERNEL_IMAGE -[o INFORMATION][-m module id][-x pid]</span><br /><span><br /></span><br /><span>-= CAUTION =-</span><br /><span>This program need to physical memory image, kernel image</span><br /><span>It support to Intel x86 architecture</span><br /><span><br /></span><br /><span>Option:</span><br /><span>-o Gathering information using symbol information:</span><br /><span>-m Dump module using module id</span><br /><span>-x Dump process using pid</span><br /><span><br /></span><br /><span>INFORMATION:</span><br /><span>proc_info<span> </span> process list</span><br /><span>syscall_info<span> </span> system call list (hooking detection)</span><br /><span>lkm_info<span> </span> Loadable Kernel Module list</span><br /><div><br />도구 다운로드: <a href="http://code.google.com/p/volafox">Volafox Code Google Site</a></div><br />volafunx는 중요 기술만 구현하였기 때문에 운영체제 버전 정보와 같은 부가적인 정보를 제공하지는 않습니다. 정말 악성코드 및 루트킷을 탐지하여 덤프하는데 중점을 둔 도구라 할 수 있습니다.(사실은 시간이 없었습니다 :-/ )<br /><br />도구의 활용성을 보여드리기 위해 시스템에  vi 에디터를 열고 키를 작성한 후 해당 프로세스 영역만을 덤프하여 분석하는 것을 테스트 해보겠습니다. 우선 프로세스 목록을 확인하여  vi  프로세스를 확인하였습니다.<br /><br /><br /><span>n0fates-iMac:volafunx n0fate$ python volafunx.py -i FreeBSD.vmem -s kernel -o proc_info</span><br /><span>[+] Memory Image: FreeBSD.vmem</span><br /><span>[+] Kernel Image: kernel</span><br /><span>[+] Information: proc_info</span><br /><span><br /></span><br /><span>-= process list =-</span><br /><span>list_entry_next<span> </span>pid<span> </span>ppid<span> </span>process name<span> </span>username</span><br /><span>c1946000<span> </span>0<span> </span>0<span> </span>kernel<span>  </span></span><br /><span>c1945aa0<span> </span>1<span> </span>0<span> </span>initl<span> </span>root<span> </span></span><br /><span>c19452a8<span> </span>2<span> </span>0<span> </span>g_event<span>  </span></span><br /><span>c1945000<span> </span>3<span> </span>0<span> </span>g_upl<span>  </span></span><br /><span>c19b1550<span> </span>4<span> </span>0<span> </span>g_down<span>  </span></span><br /><span>c19b1000<span> </span>5<span> </span>0<span> </span>xpt_thrd<span>  </span></span><br /><span>c1946d48<span> </span>6<span> </span>0<span> </span>fdc0l<span>  </span></span><br /><span>c1946aa0<span> </span>7<span> </span>0<span> </span>sctp_iterator<span>  </span></span><br /><span>c1946550<span> </span>8<span> </span>0<span> </span>pagedaemon<span>  </span></span><br /><span>c19462a8<span> </span>9<span> </span>0<span> </span>vmdaemon<span>  </span></span><br /><span>c1945d48<span> </span>10<span> </span>0<span> </span>audit<span>  </span></span><br /><span>c19457f8<span> </span>11<span> </span>0<span> </span>idlel<span>  </span></span><br /><span>c1945550<span> </span>12<span> </span>0<span> </span>intrl<span>  </span></span><br /><span>c19b12a8<span> </span>13<span> </span>0<span> </span>yarrow<span>  </span></span><br /><span>c19467f8<span> </span>14<span> </span>0<span> </span>usbel<span>  </span></span><br /><span>c1c10d48<span> </span>15<span> </span>0<span> </span>pagezero<span>  </span></span><br /><span>c1c10aa0<span> </span>16<span> </span>0<span> </span>bufdaemon<span>  </span></span><br /><span>c1c107f8<span> </span>17<span> </span>0<span> </span>syncer<span>  </span></span><br /><span>c1c10550<span> </span>18<span> </span>0<span> </span>vnlru<span>  </span></span><br /><span>c1c102a8<span> </span>19<span> </span>0<span> </span>softdepflush<span>  </span></span><br /><span>c1c6daa0<span> </span>20<span> </span>0<span> </span>flowcleaner<span>  </span></span><br /><span>c1c6d7f8<span> </span>448<span> </span>11<span> </span>devdl<span> </span>root<span> </span></span><br /><span>c19b1d48<span> </span>563<span> </span>11<span> </span>syslogd<span> </span>root<span> </span></span><br /><span>c1c6e2a8<span> </span>786<span> </span>11<span> </span>sshdl<span> </span>root<span> </span></span><br /><span>c19b1aa0<span> </span>793<span> </span>11<span> </span>sendmailer<span> </span>root<span> </span></span><br /><span>c1c6d550<span> </span>797<span> </span>11<span> </span>sendmailer<span> </span>root<span> </span></span><br /><span>c1c6d000<span> </span>803<span> </span>11<span> </span>cronl<span> </span>root<span> </span></span><br /><span>c1c10000<span> </span>854<span> </span>11<span> </span>getty<span> </span>root<span> </span></span><br /><span>c1c6d2a8<span> </span>855<span> </span>11<span> </span>getty<span> </span>root<span> </span></span><br /><span>c1ea5550<span> </span>856<span> </span>11<span> </span>getty<span> </span>root<span> </span></span><br /><span>c1ea52a8<span> </span>857<span> </span>11<span> </span>getty<span> </span>root<span> </span></span><br /><span>c1ea5000<span> </span>858<span> </span>11<span> </span>getty<span> </span>root<span> </span></span><br /><span>c1ea4d48<span> </span>859<span> </span>11<span> </span>getty<span> </span>root<span> </span></span><br /><span>c1eeb2a8<span> </span>860<span> </span>11<span> </span>getty<span> </span>root<span> </span></span><br /><span>c19b17f8<span> </span>15214<span> </span>11<span> </span>login<span> </span>root<span> </span></span><br /><span>c1ea4000<span> </span>15229<span> </span>15214<span> </span>bash<span> </span>root<span> </span></span><br /><span><span><b>c0d99b58<span> </span>47686<span> </span>15229<span> </span>vih<span> </span>root</b></span><span> </span></span><br /><span>n0fates-iMac:volafunx n0fate$ </span><br /><div><br /></div><br />빨간 줄로 그어진 것이  vi 의 프로세스입니다. 해당 프로세스 영역만을 메모리에서 덤프하겠습니다.<br /><br /><br /><span>n0fates-iMac:volafunx n0fate$ python volafunx.py -i FreeBSD.vmem -s kernel -x 47686</span><br /><span>[+] Memory Image: FreeBSD.vmem</span><br /><span>[+] Kernel Image: kernel</span><br /><span>[+] Dump PID: 47686</span><br /><span>[+] Dump Process ID: 47686</span><br /><span> [-] process name: vih</span><br /><span> [-] vmspace: c194a740</span><br /><span> [-] start: 1000</span><br /><span> [-] end: bfc00000</span><br /><span> [-] VAD CR3: c634f000</span><br /><span> [-] PHYS CR3: 3cc5000</span><br /><span>[+] END VAD DUMP LIST</span><br /><span>[+] VAD DUMP START</span><br /><span> [-] [DUMP] Image Name: vih-8048000-8092000</span><br /><span> [-] [DUMP] Image Name: vih-8092000-8100000</span><br /><span> [-] [DUMP] Image Name: vih-28092000-280c2000</span><br /><span> [-] [
    DUMP] Image Name: vih-280c2000-280c4000</span><br /><span> [-] [DUMP] Image Name: vih-280c4000-280d7000</span><br /><span> [-] [DUMP] Image Name: vih-280d7000-28114000</span><br /><span> [-] [DUMP] Image Name: vih-2
    8114000-28117000</span><br /><span> [-] [DUMP] Image Name: vih-28117000-28213000</span><br /><span> [-] [DUMP] Image Name: vih-28213000-28219000</span><br /><span> [-] [DUMP] Image Name: vih-28219000-2822f000</span><br /><span> [-] [DUMP] Image Name: vih-28300000-28400000</span><br /><span> [-] [DUMP] Image Name: vih-bfbe0000-bfc00000</span><br /><span>[+] VAD DUMP COMPLETE</span><br /><span>n0fates-iMac:volafunx n0fate$ ls -al</span><br /><br /><span>drwxrwxrwx  29 n0fate  staff       986 12 22 15:29 .</span><br /><span>drwx------+ 10 n0fate  staff       340 12 22 14:08 ..</span><br /><span>-rw-r--r--@  1 n0fate  staff      6148 12 22 15:29 .DS_Store</span><br /><span>-rwxrwxrwx@  1 n0fate  staff  67108864 12 22 14:42 FreeBSD.vmem</span><br /><span>-rwxrwxrwx   1 n0fate  staff      2109 11  1 21:14 addrspace.py</span><br /><span>-rwxr-xr-x   1 n0fate  staff      2524 12 22 14:13 addrspace.pyc</span><br /><span>-rwxrwxrwx   1 n0fate  staff      5112 12 22 15:02 elf_an.py</span><br /><span>-rwxr-xr-x   1 n0fate  staff      4311 12 22 15:18 elf_an.pyc</span><br /><span>-rwxrwxrwx   1 n0fate  staff  11492703 11  1 20:53 kernel</span><br /><span>-rwxrwxrwx   1 n0fate  staff  11984864 12 21 16:26 lkm_kernel_dump</span><br /><span>-rwxrwxrwx   1 n0fate  staff       540 11  1 20:53 setup.py</span><br /><span>-rwxrwxrwx   1 n0fate  staff   2069036 11  2 19:12 symbol.txt</span><br /><span>-rwxrwxrwx   1 n0fate  staff     16542 11  2 15:29 syscall.txt</span><br /><span>-rw-r--r--   1 n0fate  staff    122880 12 22 15:29 vih-28092000-280c2000</span><br /><span>-rw-r--r--   1 n0fate  staff      8192 12 22 15:29 vih-280c2000-280c4000</span><br /><span>-rw-r--r--   1 n0fate  staff     57344 12 22 15:29 vih-280c4000-280d7000</span><br /><span>-rw-r--r--   1 n0fate  staff    229376 12 22 15:29 vih-280d7000-28114000</span><br /><span>-rw-r--r--   1 n0fate  staff     12288 12 22 15:29 vih-28114000-28117000</span><br /><span>-rw-r--r--   1 n0fate  staff    610304 12 22 15:29 vih-28117000-28213000</span><br /><span>-rw-r--r--   1 n0fate  staff     24576 12 22 15:29 vih-28213000-28219000</span><br /><span>-rw-r--r--   1 n0fate  staff     45056 12 22 15:29 vih-28219000-2822f000</span><br /><span>-rw-r--r--   1 n0fate  staff    204800 12 22 15:29 vih-28300000-28400000</span><br /><span>-rw-r--r--   1 n0fate  staff    253952 12 22 15:29 vih-8048000-8092000</span><br /><span>-rw-r--r--   1 n0fate  staff      8192 12 22 15:29 vih-8092000-8100000</span><br /><span>-rw-r--r--   1 n0fate  staff     32768 12 22 15:29 vih-bfbe0000-bfc00000</span><br /><span>-rw-r--r--   1 n0fate  staff     10602 12 22 15:05 volafunx-0.1.zip</span><br /><span>-rwxrwxrwx   1 n0fate  staff     16793 12 22 15:04 volafunx.py</span><br /><span>-rwxrwxrwx   1 n0fate  staff     13846 11  1 21:14 x86.py</span><br /><span>-rwxr-xr-x   1 n0fate  staff     12837 12 22 14:13 x86.pyc</span><br /><span>n0fates-iMac:volafunx n0fate$ </span><br /><div><br /></div><div>덤프된 내용을 strings 로 확인해보겠습니다.</div><div><br /></div><div><div><span>n0fates-iMac:volafunx n0fate$ strings vih-* | grep "secret key"</span></div><div><span>secret key: welcome to BSD world ;)</span></div><div><span>secret key: welcome to BSD world ;)</span></div><div><span>secret key: welcome to BSD world ;) </span></div><div><span>n0fates-iMac:volafunx n0fate$ </span></div><div><br /></div></div><div>올바르게 키가 나오는 것을 확인할 수 있습니다. 이러한 프로세스 덤프는  vi의 에디팅 흔적 뿐만 아니라, 사용자가 실행했던 명령어를  bash 를 덤프하여 확인하는 등 다양한 증거를 수집할 수 있습니다. :)</div><div><br /></div><div>추가적으로 현재 오픈한 파일에 대한 목록 추출 및 해당 데이터 덤프를 구현할 예정인데 얼마나 걸릴지 모르겠네요. 현재 두 도구를 혼자서 하고 있다보니 시간이 좀 걸립니다.</div><div><br /></div><div>다들 유용하게 사용해주셨으면 감사하겠습니다. 혹시나 좋은 코멘트가 있으시다면 지체없이 글 남겨주시기 바랍니다.</div><br /><div><br /></div><div>n0fate's Forensic Space :)</div>
  fusion_builder_converted: 'yes'
author:
  login: n0fate
  email: rapfer@gmail.com
  display_name: n0fate
  first_name: ''
  last_name: ''
---
<div></div>
<div></div>
<p>사실 예전 논문의 주제로 잡았던  Mac OS X 는 개인 데스크톱에서 많이 사용되지만, 서버시장을 바라보았을 땐 그 수요가 높지 않습니다. 이에 기업에서 사용하는 서버 시장에 이 기술을 적용해볼 수 있지 않을까해서 생각을 해보니  FreeBSD에 적용하면 그 사용 빈도가 더 높지 않을까란 생각이 들었습니다.</p>
<p>이러한 생각으로 volafox 의 물리 메모리 분석 기술을  OSX 의 컴포넌트 중 하나로 사용되는  BSD 에 적용하였습니다. 아무래도  Mac OS X의 데이터 추출도 대부분  BSD 컴포넌트에서 데이터를 추출하다보니 좀더 빠르게 구현할 수 있었습니다.</p>
<p>이름은 우선  volafunx 로 정하였는데요, 이는 차 후 통합되는 과정에서 변경될 수 있습니다.<br /> volafox 를 기반으로 작성하였지만, 물리 메모리 분석에 중요한 프로세스 덤프가 먼저 추가가 되어 있기 때문에, 현재까지는  volafox 보다 사용하기는 더 좋다고 생각합니다. :)</p>
<p> volafunx 를 구동하면 다음과 같은 화면을 확인하실 수 있습니다.</p>
<p><span>n0fates-iMac:volafunx n0fate$ python volafunx.py </span></p>
<p><span>Memory analyzer for FreeBSD - n0fate</span><br /><span>Contact: rapfer@gmail.com</span><br /><span>usage: python volafunx.py -i MEMORY_IMAGE -s KERNEL_IMAGE -[fusion_builder_container hundred_percent="yes" overflow="visible"][fusion_builder_row][fusion_builder_column type="1_1" background_position="left top" background_color="" border_size="" border_color="" border_style="solid" spacing="yes" background_image="" background_repeat="no-repeat" padding="" margin_top="0px" margin_bottom="0px" class="" id="" animation_type="" animation_speed="0.3" animation_direction="left" hide_on_mobile="no" center_content="no" min_height="none"][o INFORMATION][-m module id][-x pid]</span><br /><span><br /></span><br /><span>-= CAUTION =-</span><br /><span>This program need to physical memory image, kernel image</span><br /><span>It support to Intel x86 architecture</span><br /><span><br /></span><br /><span>Option:</span><br /><span>-o Gathering information using symbol information:</span><br /><span>-m Dump module using module id</span><br /><span>-x Dump process using pid</span><br /><span><br /></span><br /><span>INFORMATION:</span><br /><span>proc_info<span> </span> process list</span><br /><span>syscall_info<span> </span> system call list (hooking detection)</span><br /><span>lkm_info<span> </span> Loadable Kernel Module list</span>
<div>도구 다운로드: <a href="http://code.google.com/p/volafox">Volafox Code Google Site</a></div>
<p>volafunx는 중요 기술만 구현하였기 때문에 운영체제 버전 정보와 같은 부가적인 정보를 제공하지는 않습니다. 정말 악성코드 및 루트킷을 탐지하여 덤프하는데 중점을 둔 도구라 할 수 있습니다.(사실은 시간이 없었습니다 :-/ )</p>
<p>도구의 활용성을 보여드리기 위해 시스템에  vi 에디터를 열고 키를 작성한 후 해당 프로세스 영역만을 덤프하여 분석하는 것을 테스트 해보겠습니다. 우선 프로세스 목록을 확인하여  vi  프로세스를 확인하였습니다.</p>
<p><span>n0fates-iMac:volafunx n0fate$ python volafunx.py -i FreeBSD.vmem -s kernel -o proc_info</span><br /><span>[+] Memory Image: FreeBSD.vmem</span><br /><span>[+] Kernel Image: kernel</span><br /><span>[+] Information: proc_info</span><br /><span><br /></span><br /><span>-= process list =-</span><br /><span>list_entry_next<span> </span>pid<span> </span>ppid<span> </span>process name<span> </span>username</span><br /><span>c1946000<span> </span>0<span> </span>0<span> </span>kernel<span>  </span></span><br /><span>c1945aa0<span> </span>1<span> </span>0<span> </span>initl<span> </span>root<span> </span></span><br /><span>c19452a8<span> </span>2<span> </span>0<span> </span>g_event<span>  </span></span><br /><span>c1945000<span> </span>3<span> </span>0<span> </span>g_upl<span>  </span></span><br /><span>c19b1550<span> </span>4<span> </span>0<span> </span>g_down<span>  </span></span><br /><span>c19b1000<span> </span>5<span> </span>0<span> </span>xpt_thrd<span>  </span></span><br /><span>c1946d48<span> </span>6<span> </span>0<span> </span>fdc0l<span>  </span></span><br /><span>c1946aa0<span> </span>7<span> </span>0<span> </span>sctp_iterator<span>  </span></span><br /><span>c1946550<span> </span>8<span> </span>0<span> </span>pagedaemon<span>  </span></span><br /><span>c19462a8<span> </span>9<span> </span>0<span> </span>vmdaemon<span>  </span></span><br /><span>c1945d48<span> </span>10<span> </span>0<span> </span>audit<span>  </span></span><br /><span>c19457f8<span> </span>11<span> </span>0<span> </span>idlel<span>  </span></span><br /><span>c1945550<span> </span>12<span> </span>0<span> </span>intrl<span>  </span></span><br /><span>c19b12a8<span> </span>13<span> </span>0<span> </span>yarrow<span>  </span></span><br /><span>c19467f8<span> </span>14<span> </span>0<span> </span>usbel<span>  </span></span><br /><span>c1c10d48<span> </span>15<span> </span>0<span> </span>pagezero<span>  </span></span><br /><span>c1c10aa0<span> </span>16<span> </span>0<span> </span>bufdaemon<span>  </span></span><br /><span>c1c107f8<span> </span>17<span> </span>0<span> </span>syncer<span>  </span></span><br /><span>c1c10550<span> </span>18<span> </span>0<span> </span>vnlru<span>  </span></span><br /><span>c1c102a8<span> </span>19<span> </span>0<span> </span>softdepflush<span>  </span></span><br /><span>c1c6daa0<span> </span>20<span> </span>0<span> </span>flowcleaner<span>  </span></span><br /><span>c1c6d7f8<span> </span>448<span> </span>11<span> </span>devdl<span> </span>root<span> </span></span><br /><span>c19b1d48<span> </span>563<span> </span>11<span> </span>syslogd<span> </span>root<span> </span></span><br /><span>c1c6e2a8<span> </span>786<span> </span>11<span> </span>sshdl<span> </span>root<span> </span></span><br /><span>c19b1aa0<span> </span>793<span> </span>11<span> </span>sendmailer<span> </span>root<span> </span></span><br /><span>c1c6d550<span> </span>797<span> </span>11<span> </span>sendmailer<span> </span>root<span> </span></span><br /><span>c1c6d000<span> </span>803<span> </span>11<span> </span>cronl<span> </span>root<span> </span></span><br /><span>c1c10000<span> </span>854<span> </span>11<span> </span>getty<span> </span>root<span> </span></span><br /><span>c1c6d2a8<span> </span>855<span> </span>11<span> </span>getty<span> </span>root<span> </span></span><br /><span>c1ea5550<span> </span>856<span> </span>11<span> </span>getty<span> </span>root<span> </span></span><br /><span>c1ea52a8<span> </span>857<span> </span>11<span> </span>getty<span> </span>root<span> </span></span><br /><span>c1ea5000<span> </span>858<span> </span>11<span> </span>getty<span> </span>root<span> </span></span><br /><span>c1ea4d48<span> </span>859<span> </span>11<span> </span>getty<span> </span>root<span> </span></span><br /><span>c1eeb2a8<span> </span>860<span> </span>11<span> </span>getty<span> </span>root<span> </span></span><br /><span>c19b17f8<span> </span>15214<span> </span>11<span> </span>login<span> </span>root<span> </span></span><br /><span>c1ea4000<span> </span>15229<span> </span>15214<span> </span>bash<span> </span>root<span> </span></span><br /><span><span><b>c0d99b58<span> </span>47686<span> </span>15229<span> </span>vih<span> </span>root</b></span><span> </span></span><br /><span>n0fates-iMac:volafunx n0fate$ </span>
<div></div>
<p>빨간 줄로 그어진 것이  vi 의 프로세스입니다. 해당 프로세스 영역만을 메모리에서 덤프하겠습니다.</p>
<p><span>n0fates-iMac:volafunx n0fate$ python volafunx.py -i FreeBSD.vmem -s kernel -x 47686</span><br /><span>[+] Memory Image: FreeBSD.vmem</span><br /><span>[+] Kernel Image: kernel</span><br /><span>[+] Dump PID: 47686</span><br /><span>[+] Dump Process ID: 47686</span><br /><span> [-] process name: vih</span><br /><span> [-] vmspace: c194a740</span><br /><span> [-] start: 1000</span><br /><span> [-] end: bfc00000</span><br /><span> [-] VAD CR3: c634f000</span><br /><span> [-] PHYS CR3: 3cc5000</span><br /><span>[+] END VAD DUMP LIST</span><br /><span>[+] VAD DUMP START</span><br /><span> [-] [DUMP] Image Name: vih-8048000-8092000</span><br /><span> [-] [DUMP] Image Name: vih-8092000-8100000</span><br /><span> [-] [DUMP] Image Name: vih-28092000-280c2000</span><br /><span> [-] [<br />
DUMP] Image Name: vih-280c2000-280c4000</span><br /><span> [-] [DUMP] Image Name: vih-280c4000-280d7000</span><br /><span> [-] [DUMP] Image Name: vih-280d7000-28114000</span><br /><span> [-] [DUMP] Image Name: vih-2<br />
8114000-28117000</span><br /><span> [-] [DUMP] Image Name: vih-28117000-28213000</span><br /><span> [-] [DUMP] Image Name: vih-28213000-28219000</span><br /><span> [-] [DUMP] Image Name: vih-28219000-2822f000</span><br /><span> [-] [DUMP] Image Name: vih-28300000-28400000</span><br /><span> [-] [DUMP] Image Name: vih-bfbe0000-bfc00000</span><br /><span>[+] VAD DUMP COMPLETE</span><br /><span>n0fates-iMac:volafunx n0fate$ ls -al</span></p>
<p><span>drwxrwxrwx  29 n0fate  staff       986 12 22 15:29 .</span><br /><span>drwx------+ 10 n0fate  staff       340 12 22 14:08 ..</span><br /><span>-rw-r--r--@  1 n0fate  staff      6148 12 22 15:29 .DS_Store</span><br /><span>-rwxrwxrwx@  1 n0fate  staff  67108864 12 22 14:42 FreeBSD.vmem</span><br /><span>-rwxrwxrwx   1 n0fate  staff      2109 11  1 21:14 addrspace.py</span><br /><span>-rwxr-xr-x   1 n0fate  staff      2524 12 22 14:13 addrspace.pyc</span><br /><span>-rwxrwxrwx   1 n0fate  staff      5112 12 22 15:02 elf_an.py</span><br /><span>-rwxr-xr-x   1 n0fate  staff      4311 12 22 15:18 elf_an.pyc</span><br /><span>-rwxrwxrwx   1 n0fate  staff  11492703 11  1 20:53 kernel</span><br /><span>-rwxrwxrwx   1 n0fate  staff  11984864 12 21 16:26 lkm_kernel_dump</span><br /><span>-rwxrwxrwx   1 n0fate  staff       540 11  1 20:53 setup.py</span><br /><span>-rwxrwxrwx   1 n0fate  staff   2069036 11  2 19:12 symbol.txt</span><br /><span>-rwxrwxrwx   1 n0fate  staff     16542 11  2 15:29 syscall.txt</span><br /><span>-rw-r--r--   1 n0fate  staff    122880 12 22 15:29 vih-28092000-280c2000</span><br /><span>-rw-r--r--   1 n0fate  staff      8192 12 22 15:29 vih-280c2000-280c4000</span><br /><span>-rw-r--r--   1 n0fate  staff     57344 12 22 15:29 vih-280c4000-280d7000</span><br /><span>-rw-r--r--   1 n0fate  staff    229376 12 22 15:29 vih-280d7000-28114000</span><br /><span>-rw-r--r--   1 n0fate  staff     12288 12 22 15:29 vih-28114000-28117000</span><br /><span>-rw-r--r--   1 n0fate  staff    610304 12 22 15:29 vih-28117000-28213000</span><br /><span>-rw-r--r--   1 n0fate  staff     24576 12 22 15:29 vih-28213000-28219000</span><br /><span>-rw-r--r--   1 n0fate  staff     45056 12 22 15:29 vih-28219000-2822f000</span><br /><span>-rw-r--r--   1 n0fate  staff    204800 12 22 15:29 vih-28300000-28400000</span><br /><span>-rw-r--r--   1 n0fate  staff    253952 12 22 15:29 vih-8048000-8092000</span><br /><span>-rw-r--r--   1 n0fate  staff      8192 12 22 15:29 vih-8092000-8100000</span><br /><span>-rw-r--r--   1 n0fate  staff     32768 12 22 15:29 vih-bfbe0000-bfc00000</span><br /><span>-rw-r--r--   1 n0fate  staff     10602 12 22 15:05 volafunx-0.1.zip</span><br /><span>-rwxrwxrwx   1 n0fate  staff     16793 12 22 15:04 volafunx.py</span><br /><span>-rwxrwxrwx   1 n0fate  staff     13846 11  1 21:14 x86.py</span><br /><span>-rwxr-xr-x   1 n0fate  staff     12837 12 22 14:13 x86.pyc</span><br /><span>n0fates-iMac:volafunx n0fate$ </span>
<div></div>
<div>덤프된 내용을 strings 로 확인해보겠습니다.</div>
<div></div>
<div>
<div><span>n0fates-iMac:volafunx n0fate$ strings vih-* | grep "secret key"</span></div>
<div><span>secret key: welcome to BSD world ;)</span></div>
<div><span>secret key: welcome to BSD world ;)</span></div>
<div><span>secret key: welcome to BSD world ;) </span></div>
<div><span>n0fates-iMac:volafunx n0fate$ </span></div>
<div></div>
</div>
<div>올바르게 키가 나오는 것을 확인할 수 있습니다. 이러한 프로세스 덤프는  vi의 에디팅 흔적 뿐만 아니라, 사용자가 실행했던 명령어를  bash 를 덤프하여 확인하는 등 다양한 증거를 수집할 수 있습니다. :)</div>
<div></div>
<div>추가적으로 현재 오픈한 파일에 대한 목록 추출 및 해당 데이터 덤프를 구현할 예정인데 얼마나 걸릴지 모르겠네요. 현재 두 도구를 혼자서 하고 있다보니 시간이 좀 걸립니다.</div>
<div></div>
<div>다들 유용하게 사용해주셨으면 감사하겠습니다. 혹시나 좋은 코멘트가 있으시다면 지체없이 글 남겨주시기 바랍니다.</div>
<p>
<div></div>
<div>n0fate's Forensic Space :)</div>
<p>[/fusion_builder_column][/fusion_builder_row][/fusion_builder_container]</p>
